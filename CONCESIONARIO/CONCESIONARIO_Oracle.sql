
ALTER SESSION SET NLS_DATE_FORMAT='MM-DD-YYYY';

CREATE TABLE CONCESIONARIO(
    
    codigo      VARCHAR2(6) PRIMARY KEY ,
    nombre      VARCHAR2(30),
    direccion   VARCHAR2(60),
    ciudad      VARCHAR2(20),
    provincia   VARCHAR2(20)

);

CREATE TABLE VEHICULO(

    matricula       VARCHAR2(7) PRIMARY KEY,
    marca           VARCHAR2(10),
    modelo          VARCHAR2(12),
    año_fab         DATE,
    kilometros      NUMBER(7),
    observaciones   VARCHAR2(500),
    clase           VARCHAR2(15),
    concesionario   VARCHAR2(6),
    CONSTRAINT FK_CON_COD       FOREIGN KEY (concesionario) REFERENCES CONCESIONARIO(codigo) ON DELETE CASCADE
    
);

CREATE TABLE CLIENTE(

    dni             VARCHAR(10) PRIMARY KEY,
    nombre          VARCHAR2(30),    
    apellidos       VARCHAR2(30),
    fec_nac         DATE,
    fec_carnet      DATE,
    bonificacion    NUMBER,
    CONSTRAINT DNI_CHECK       CHECK (REGEXP_LIKE(dni, '^[0-9]{8}[a-zA-Z]$'))

);

CREATE TABLE ALQUILAR(

    matricula       VARCHAR2(7),
    dni             VARCHAR2(10),
    fec_alquiler    DATE,
    fec_entrega     DATE,
    kms_recorre     NUMBER,
    incidentes      VARCHAR2(500),
    importe         NUMBER,
    CONSTRAINT DNI_CHECK2       CHECK (REGEXP_LIKE(dni, '^[0-9]{8}[A-Z]$')),
    CONSTRAINT PK_DNI_MA_FALQ   PRIMARY KEY (matricula,dni,fec_alquiler),
    CONSTRAINT FK_VEH_MAT       FOREIGN KEY (matricula) REFERENCES VEHICULO(matricula)ON DELETE CASCADE,
    CONSTRAINT FK_CLI_DNI       FOREIGN KEY (dni) REFERENCES CLIENTE(dni) ON DELETE CASCADE
);

INSERT INTO CONCESIONARIO VALUES('000001','CONCESUR','POLIGONO EL PINO','SEVILLA','SEVILLA');
INSERT INTO CONCESIONARIO VALUES('000002','CONCESTE','POLIGONO CABEZA HERMOSA','SEVILLA ESTE','SEVILLA');
INSERT INTO CONCESIONARIO VALUES('000003','CONCEOESTE','POLIGONO JUNCAL','MAZAGON','HUELVA');
INSERT INTO CONCESIONARIO VALUES('000004','CONCENORTE','POLIGONO CALONGE','CABRA','CORDOBA');



INSERT INTO VEHICULO VALUES('2215LKJ','Renault','Clio','01-01-2021',56000, 'Revision Correcta 01-03-2023', 'A', '000001' );
INSERT INTO VEHICULO VALUES('3114MHI','Peugeot','3008','01-01-2022',75600, NULL, 'A', '000001' );
INSERT INTO VEHICULO VALUES('8885MMD','Mercedes','GLC350','01-01-2023',1500, 'Revision Correcta 01-03-2023', 'A', '000003' );
INSERT INTO VEHICULO VALUES('4125JFC','Renault','Captur','01-01-2017',30000, 'Revision Correcta 01-03-2023', 'B', '000003' );
INSERT INTO VEHICULO VALUES('6598HGF','Nissan','Qasqhai','01-01-2019',89100, NULL, 'B','000002' );
INSERT INTO VEHICULO VALUES('1147FKN','Nissan','Micra','01-01-2019',155600, 'Revision Correcta 01-01-2023', 'A', '000001' );
INSERT INTO VEHICULO VALUES('5442HHN','Opel','Mokka','01-01-2019',45200, NULL, 'B', '000002' );
INSERT INTO VEHICULO VALUES('6541JHF','Volkswagen','Golf VII','01-01-2020',65000, NULL, 'A','000004' );
INSERT INTO VEHICULO VALUES('5421KKJ','Volkswagen','Polo','01-01-2020',45600, 'En taller', 'B', '000004' );
INSERT INTO VEHICULO VALUES('6565FRS','BMW','X1','01-01-2018',190500, NULL, 'A', '000003' );
INSERT INTO VEHICULO VALUES('9851KGF','BMW','330','01-01-2020',85100, NULL, 'B', '000001' );
INSERT INTO VEHICULO VALUES('1249DDK','Mercedes','A160','01-01-2018',225600, 'Revision proxima', 'A', '000002' );
INSERT INTO VEHICULO VALUES('9877EGR','Peugeot','307','01-01-2009',285600, 'Puerta copiloto arañada', 'A', '000002' );
INSERT INTO VEHICULO VALUES('5421DEK','Renault','Twingo','01-01-2008',275200, 'Tapiceria Deteriorada', 'A', '000003' );
INSERT INTO VEHICULO VALUES('4848DRB','Nissan','Almera','01-01-2011',215600, 'Revision Correcta 01-01-2023', 'A', '000004' );
INSERT INTO VEHICULO VALUES('3232DCV','Ford','Fiesta','01-01-2007',355000, 'SIN ITV', 'C', '000001' );



INSERT INTO CLIENTE VALUES('11111111A','Juan','Gonzalez Fernandez','03-24-1986','09-29-2023', 15 );
INSERT INTO CLIENTE VALUES('22222222B','Ramon','Rodriguez Fernandez','09-02-1999','05-01-2018', 10 );
INSERT INTO CLIENTE VALUES('33333333C','María','Martin Saez','11-24-2000','01-11-2023', 0 );
INSERT INTO CLIENTE VALUES('44444444D','Laura','Gutierrez Añon','06-04-2001','05-20-2024', 0 );
INSERT INTO CLIENTE VALUES('55555555E','Inma','Dominguez Cerrato','03-03-1993','12-24-2014',5);
INSERT INTO CLIENTE VALUES('44155222X','Jose','Torres Lopez','03-24-1980','07-07-2008', 15 );
INSERT INTO CLIENTE VALUES('74747474G','Luis','Miguel Casado','08-01-1998','05-14-2018', 20 );
INSERT INTO CLIENTE VALUES('85858585H','Francisco','Heiver Jhons','05-25-1994','09-27-2013', 25 );
INSERT INTO CLIENTE VALUES('96969696I','Salvador','Rubiales Perez','08-02-1992','04-01-2011', 0 );
INSERT INTO CLIENTE VALUES('25252525J','Ascension','Rodriguez Ruiz','06-24-1992','02-22-2011', 15 );


INSERT INTO ALQUILAR VALUES('6598HGF','55555555E','12-14-2021','01-08-2022',846,NULL, 700 );
INSERT INTO ALQUILAR VALUES('4848DRB','55555555E','04-05-2016','04-10-2016',420,NULL, 225 );
INSERT INTO ALQUILAR VALUES('4848DRB','25252525J','04-01-2016','04-04-2016',210,NULL, 180 );
INSERT INTO ALQUILAR VALUES('4848DRB','85858585H','04-10-2016','04-11-2016',130,'Arañazo en faldon trasero', 75 );
INSERT INTO ALQUILAR VALUES('4848DRB','11111111A','04-13-2016','04-19-2016',500,NULL, 350 );
INSERT INTO ALQUILAR VALUES('4848DRB','96969696I','04-20-2016','04-22-2016',300,NULL, 200 );
INSERT INTO ALQUILAR VALUES('4848DRB','11111111A','04-27-2016','04-30-2016',240,NULL, 270 );
INSERT INTO ALQUILAR VALUES('6541JHF','55555555E','01-14-2015','01-19-2015',380,NULL, 350 );
INSERT INTO ALQUILAR VALUES('6541JHF','55555555E','03-12-2015','03-19-2015',600,'Multa de aparcamiento, reclamar 100€', 750 );
INSERT INTO ALQUILAR VALUES('6541JHF','55555555E','04-23-2015','04-25-2015',140,NULL, 225 );
INSERT INTO ALQUILAR VALUES('6541JHF','55555555E','06-18-2015','06-23-2015',300,'Cliente indica que pincho rueda delantera izquierda', 400 );
INSERT INTO ALQUILAR VALUES('6541JHF','55555555E','10-01-2015','10-07-2015',430,NULL, 650);
INSERT INTO ALQUILAR VALUES('6541JHF','55555555E','12-11-2015','12-12-2015',90,'Deposito sin llenar', 70 );
INSERT INTO ALQUILAR VALUES('6598HGF','74747474G','12-14-2019','01-16-2020',1200,'Multa exceso velocidad, reclamar 200€', 1750 );
INSERT INTO ALQUILAR VALUES('4848DRB','33333333C','01-19-2023','01-22-2023',290,NULL, 400 );
INSERT INTO ALQUILAR VALUES('1249DDK','55555555E','07-05-2019','07-08-2019',180,NULL, 150 );
